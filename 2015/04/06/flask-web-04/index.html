<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Flask Web 开发学习笔记（四） · 一鸣的博客</title><meta name="description" content="Flask Web 开发学习笔记（四） - iYiming"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.jpg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://iYiming.me/atom.xml" title="一鸣的博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpg"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/jiajiayouba" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/iYiming" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Flask Web 开发学习笔记（四）</h1><div class="post-info">2015年4月6日</div><div class="post-content"><p>本次主要介绍下 Web 表单。</p>
<p>尽管 Flask 的请求对象提供的对象足够用于处理 Web 表单（如：<code>request.form</code> 能获取 POST 请求中提交的表单数据），但有些任务很单调，而且要重复操作。比如生成表单的 HTML 代码和验证提交的表单数据。</p>
<p>Flask-WTF (<a href="http://pythonhosted.org/Flask-WTF" target="_blank" rel="external">http://pythonhosted.org/Flask-WTF</a>)扩展可以把处理 Web 表单的过程编程一种愉快的体验。这个扩展对独立的 WTForms(<a href="http://wtforms.simplecodes.com" target="_blank" rel="external">http://wtforms.simplecodes.com</a>)包进行了包装，方便集成到 Flask 程序中。</p>
<h2 id="安装-Flask-WTF"><a href="#安装-Flask-WTF" class="headerlink" title="安装 Flask-WTF"></a>安装 Flask-WTF</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install flask-wtf</div></pre></td></tr></table></figure>
<h2 id="跨站请求伪造保护"><a href="#跨站请求伪造保护" class="headerlink" title="跨站请求伪造保护"></a>跨站请求伪造保护</h2><p>默认情况下，Flask-WTF 能保护所有表单面免受跨站请求伪造（Cross-Site Request Forgery，CSRF）的攻击。恶意网站把请求发送到被攻击者已登录的其他网站是就会引发 CSRF 攻击。</p>
<p>为了实现 CSRF 保护，Flask-WTF 需要程序设置一个密钥。Flask-WTF 使用这个密钥生成加密令牌，再用令牌验证请求中表单数据的真伪。</p>
<h4 id="设置方式"><a href="#设置方式" class="headerlink" title="设置方式"></a>设置方式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">app = Flask(__name__)</div><div class="line">app.config[&apos;SECRET_KEY&apos;] = &apos;这里设置密钥&apos;</div></pre></td></tr></table></figure>
<p>注意：为了增强安全性，密钥不应该直接写入代码，而要保存在环境变量中。</p>
<h2 id="表单类"><a href="#表单类" class="headerlink" title="表单类"></a>表单类</h2><p>index.html 文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;</div><div class="line">	&lt;head&gt;</div><div class="line">		&lt;title&gt;首页&lt;/title&gt;</div><div class="line">	&lt;/head&gt;</div><div class="line">	&lt;body&gt;</div><div class="line">		&#123;% if name %&#125;</div><div class="line">			&lt;h1&gt;Hello,&#123;&#123; name &#125;&#125;!&lt;/h1&gt;</div><div class="line">		&#123;% else %&#125;</div><div class="line">			&lt;h1&gt;Hello Stranger!&lt;/h1&gt;</div><div class="line">		&#123;% endif %&#125;</div><div class="line"></div><div class="line">		&lt;form method=&quot;POST&quot;&gt;</div><div class="line">			&#123;&#123; form.hidden_tag() &#125;&#125;</div><div class="line">			&#123;&#123; form.name.label  &#125;&#125; &#123;&#123; form.name() &#125;&#125;</div><div class="line">			&#123;&#123; form.submit() &#125;&#125;</div><div class="line">		&lt;/form&gt;</div><div class="line">	&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>解释下：</p>
<blockquote>
<p>0.如果有 <code>name</code> 则输出 <code>Hello,xxx!</code> ,没有 <code>name</code> 则输出 <code>Hello,Stranger!</code></p>
<p>1.<code>form.hidden_tag()</code> 是一个隐藏字段的标识字符串</p>
<p>2.<code>form.name()</code>是下面 app.py 中 NameForm 类的一个 name 字段（输入文本框），<code>form.name.label</code>则是name字段中的第一个参数值字符串</p>
<p>3.同理 <figure class="highlight plain"><figcaption><span>```是提交按钮</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">app.py 文件：</div><div class="line"></div><div class="line">``` PYTHON</div><div class="line">from flask import Flask,render_template</div><div class="line">from flask.ext.wtf import Form</div><div class="line">from flask.ext.bootstrap import Bootstrap</div><div class="line">from wtforms import StringField,SubmitField</div><div class="line">from wtforms.validators import Required</div><div class="line"></div><div class="line">class NameForm(Form):</div><div class="line">    name = StringField(&apos;你的名字？&apos;,validators=[Required()])</div><div class="line">    submit = SubmitField(&apos;提交&apos;)</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.config[&apos;SECRET_KEY&apos;] = &apos;ni cai&apos;</div><div class="line">bootstrap = Bootstrap(app)</div><div class="line"></div><div class="line">@app.route(&apos;/&apos;,methods=[&apos;GET&apos;,&apos;POST&apos;])</div><div class="line">def index():</div><div class="line">    name = None</div><div class="line">    nameForm = NameForm()</div><div class="line"></div><div class="line">    if nameForm.validate_on_submit():</div><div class="line">        name = nameForm.name.data</div><div class="line">        nameForm.name.data = &apos;&apos;</div><div class="line">    </div><div class="line">    return render_template(&apos;index.html&apos;,form=nameForm,name=name)</div><div class="line"></div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    app.run(debug=True)</div></pre></td></tr></table></figure></p>
</blockquote>
<p>解释下：</p>
<blockquote>
<p>0.<code>NameForm</code> 类，声明了一个输入姓名文本框和提交按钮。字段构造函数第一个参数吧表单渲染成 HTML 时使用的标号。其中输入姓名的文本框需要必须填写。</p>
<p>1.<code>app.route</code> 修饰器中添加的 methods 参数告诉 Flask 在 URL 映射中把这个视图函数注册为 GET 和 POST 请求的处理程序，如果没有指定 methods 参数，就只把视图函数注册为 GET 请求处理程序。因为Web表单提交为 POST 方式，故需要显示标明。</p>
<p>2.<code>nameForm.validate_on_submit()</code> 方法，提交表单后，如果数据鞥被所有验证函数接受，那么 <code>nameForm.validate_on_submit()</code> 方法返回 <code>True</code>，否则返回 <code>False</code>。</p>
</blockquote>
<p>到这里就可以看见下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/139348-cf4f40f795fc93ca.png" alt="flask_04_01.png"></p>
<p>在文本框中输入Tom看见下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/139348-dafa5c4b6fd4ab3b.png" alt="flask_04_02.png"></p>
<h2 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h2><p>显示的界面以及功能都比较粗糙，主要存在以下几个问题：  </p>
<ul>
<li>界面很简陋，没有优美的 CSS 样式  </li>
<li>提交完数据后，按快捷键刷新浏览器会出现弹框提示：是否重新提交表单数据  </li>
<li>添加提示指示 </li>
</ul>
<h4 id="界面显示优化"><a href="#界面显示优化" class="headerlink" title="界面显示优化"></a>界面显示优化</h4><p>前面介绍了 Flask-Bootstrap 这个优秀的前端显示方案，完全可以拿过来用，并且 Flask-Bootstrap 还提供了一个非常高端的辅助函数，可以使用 Bootstrap 中预先定义好的表单演示渲染整个 Flask-WTF 表单，而这些操作只需一次调用即可完成。</p>
<p>前面介绍了 base.html 这里就不提及了。</p>
<p>index.html 文件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;% extends "base.html" %&#125;</div><div class="line">&#123;% import "bootstrap/wtf.html" as wtf %&#125;</div><div class="line"></div><div class="line"></div><div class="line">&#123;% block title %&#125;首页 &#123;% endblock %&#125;</div><div class="line"></div><div class="line">&#123;% block page_content %&#125;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-header"</span>&gt;</span></div><div class="line">&#123;% if name %&#125;</div><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span> Hello,&#123;&#123; name &#125;&#125;! <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">&#123;% else %&#125;</div><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello,Stranger!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">&#123;% endif %&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">&#123;&#123; wtf.quick_form(form) &#125;&#125;</div><div class="line"></div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure>
<p>解释下：</p>
<blockquote>
<p><code>wtf.quick_form()</code> 函数的参数为 Flask-WTF 表单对象，使用 Bootstrap 样式渲染传入的表单。</p>
</blockquote>
<p>运行效果如下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/139348-1103eeaa8f40ea7b.png" alt="flask_04_03.png"></p>
<h4 id="解决重复提交出现弹框问题"><a href="#解决重复提交出现弹框问题" class="headerlink" title="解决重复提交出现弹框问题"></a>解决重复提交出现弹框问题</h4><p>之所以出现这种情况，是因为刷新页面时浏览器会重新发送之前已经发送过的最后一个请求。</p>
<p>解决方案：不让 Web 程序把 POST 请求作为浏览器发送的最后一个请求——重定向。</p>
<p>修改 app.py 文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template,session,url_for,redirect</div><div class="line"><span class="keyword">from</span> flask.ext.wtf <span class="keyword">import</span> Form</div><div class="line"><span class="keyword">from</span> flask.ext.bootstrap <span class="keyword">import</span> Bootstrap</div><div class="line"><span class="keyword">from</span> wtforms <span class="keyword">import</span> StringField,SubmitField</div><div class="line"><span class="keyword">from</span> wtforms.validators <span class="keyword">import</span> Required</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NameForm</span><span class="params">(Form)</span>:</span></div><div class="line">    name = StringField(<span class="string">'你的名字？'</span>,validators=[Required()])</div><div class="line">    submit = SubmitField(<span class="string">'提交'</span>)</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.config[<span class="string">'SECRET_KEY'</span>] = <span class="string">'ni cai'</span></div><div class="line">bootstrap = Bootstrap(app)</div><div class="line"></div><div class="line"><span class="meta">@app.route('/',methods=['GET','POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    name = <span class="keyword">None</span></div><div class="line">    nameForm = NameForm()</div><div class="line"></div><div class="line">    <span class="keyword">if</span> nameForm.validate_on_submit():</div><div class="line">        session[<span class="string">'name'</span>] = nameForm.name.data</div><div class="line">        nameForm.name.data = <span class="string">''</span></div><div class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>,form=nameForm,name=session.get(<span class="string">'name'</span>))</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(debug=<span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<p>解释下：</p>
<blockquote>
<p>0.<code>session[&#39;name&#39;]</code> 存储了同一个会话的中文本框中的内容</p>
<p>1.<code>url_for()</code> ,当然 <code>redirect(url_for(&#39;index&#39;))</code> 也可以写成<code>redirect(&#39;/&#39;)</code> ,但是推荐使用 <code>url_for()</code> 生成 URL，因为这个函数使用 URL映射生成 URL，从而保证 URL 和定义的路由兼容，而且修改路由名字后依然后依然可用。<code>url_for()</code>函数的第一个且唯一必须指定的参数是端点名，即路由的内部名字，默认情况下，路由的端点是相应视图函数的名字，在这个示例中，处理跟地址的视图函数是 <code>index()</code>,因此传给 <code>url_for()</code> 函数的名字是 <code>index</code>。</p>
<p>2.<code>session.get(&#39;name&#39;)</code> 直接从会话中中读出 name 参数的值，也可以使用<code>session[&#39;name&#39;]</code>读取，但是推荐使用 <code>session.get(&#39;name&#39;)</code> ,使用<code>get()</code> 获取字典中键对应的值以避免未找到键的异常情况，因为对于不存在的键，<code>get()</code>会返回默认值 <code>None</code></p>
</blockquote>
<h4 id="添加提示"><a href="#添加提示" class="headerlink" title="添加提示"></a>添加提示</h4><p>请求完成后，有时需要让用户知道状态发生了变化。</p>
<p>这种提示功能是 Flask 的核心特性，<code>flash()</code> 函数可实现这种效果。</p>
<p>app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template,session,url_for,redirect,flash</div><div class="line"><span class="keyword">from</span> flask.ext.wtf <span class="keyword">import</span> Form</div><div class="line"><span class="keyword">from</span> flask.ext.bootstrap <span class="keyword">import</span> Bootstrap</div><div class="line"><span class="keyword">from</span> wtforms <span class="keyword">import</span> StringField,SubmitField</div><div class="line"><span class="keyword">from</span> wtforms.validators <span class="keyword">import</span> Required</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NameForm</span><span class="params">(Form)</span>:</span></div><div class="line">    name = StringField(<span class="string">'你的名字？'</span>,validators=[Required()])</div><div class="line">    submit = SubmitField(<span class="string">'提交'</span>)</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.config[<span class="string">'SECRET_KEY'</span>] = <span class="string">'ni cai'</span></div><div class="line">bootstrap = Bootstrap(app)</div><div class="line"></div><div class="line"><span class="meta">@app.route('/',methods=['GET','POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    name = <span class="keyword">None</span></div><div class="line">    nameForm = NameForm()</div><div class="line"></div><div class="line">    <span class="keyword">if</span> nameForm.validate_on_submit():</div><div class="line">        newName = nameForm.name.data</div><div class="line"></div><div class="line">        <span class="keyword">if</span> newName == session.get(<span class="string">'name'</span>):</div><div class="line">            session[<span class="string">'name'</span>] = nameForm.name.data</div><div class="line">            nameForm.name.data = <span class="string">''</span></div><div class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            flash(<span class="string">'名字输入错误!'</span>)</div><div class="line">            </div><div class="line">    </div><div class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>,form=nameForm,name=session.get(<span class="string">'name'</span>))</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(debug=<span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<p>base.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&#123;% extends "bootstrap/base.html" %&#125;</div><div class="line"></div><div class="line">&#123;% block title %&#125;Flasky &#123;% endblock %&#125;</div><div class="line"></div><div class="line">&#123;% block navbar %&#125;</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar navbar-inverse"</span> <span class="attr">role</span>=<span class="string">"navigation"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-header"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"navbar-toggle"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">".navbar-collapse"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Toggle navigation<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>Flasky<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-collapse collapse"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">&#123;% endblock %&#125;</div><div class="line"></div><div class="line">&#123;% block content %&#125;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">&#123;% for message in get_flashed_messages() %&#125;</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-warning"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"alert"</span>&gt;</span>×<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">&#123;&#123; message &#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">&#123;% endfor %&#125;</div><div class="line"></div><div class="line">&#123;% block page_content %&#125;&#123;% endblock %&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure>
<p>实现功能：如果用户输入的名字，不是第一次输入表单中的名字，则会出现名字输入错误提示。</p>
<p>解释下：</p>
<blockquote>
<p><code>get_flashed_messages()</code> 函数用来获取并渲染的消息。</p>
</blockquote>
</div></article></div></section><footer><div class="paginator"><a href="/2015/04/07/flask-web-05/" class="prev">上一篇</a><a href="/2015/03/22/flask-web-03/" class="next">下一篇</a></div><div data-thread-key="2015/04/06/flask-web-04/" data-title="Flask Web 开发学习笔记（四）" data-url="http://iYiming.me/2015/04/06/flask-web-04/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"jiajiayouba"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2014 - 2016 <a href="http://iYiming.me">iYiming</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253468447'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s6.cnzz.com/z_stat.php%3Fid%3D1253468447%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?3cec0b24b46b86302d1aa3b050d4668f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
    })();</script></body></html>